CREATE VIEW [COMPRA_VIEW]
AS 

	SELECT DISTINCT 
		  FUNC.NOM_FUNCIONARIO AS FUNCIONARIO
		, CLI.NOM_CLIENTE   AS CLIENTE
		, VENDA.DES_CHASSI      AS CARRO
		, MODE.NOM_MODELO 	    AS MODELO
		, COR.NOM_COR 			AS COR
		, CAR.VAL_PRECO 		AS VALOR_CARRO
		, SEG.ID_SEGURO 		AS SEGURO
		,VENDA.DTA_VENDA        AS DTA_VENDA
		
		FROM FUNCIONARIO_VENDA_AUTO VENDA
			LEFT JOIN CLIENTE_AUTOMOVEL CLI_AUTO ON (CLI_AUTO.DES_CHASSI = VENDA.DES_CHASSI)
			LEFT JOIN AUTOMOVEL 		 CAR ON (CAR.DES_CHASSI = VENDA.DES_CHASSI)
			LEFT JOIN SEGURO_AUTOMOVEL  SEG ON (SEG.DES_CHASSI = VENDA.DES_CHASSI)
			LEFT JOIN MODELO 				 MODE ON (MODE.ID_MODELO = CAR.ID_MODELO)
			LEFT JOIN COR 					 COR ON (COR.ID_COR = CAR.ID_COR)
			LEFT JOIN CLIENTE CLI ON CLI.NUM_CPF = CLI_AUTO.NUM_CPF_CLIENTE
			LEFT JOIN FUNCIONARIO FUNC ON FUNC.NUM_CPF = VENDA.NUM_CPF_FUNCIONARIO;